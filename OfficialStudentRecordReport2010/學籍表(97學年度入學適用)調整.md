# 學籍表(97學年度入學適用) 程式碼分析

## 檔案位置
`OfficialStudentRecordReport2010.cs` 第 36-55 行

## 程式碼功能概述
這段程式碼是 `OfficialStudentRecordReport2010` 類別的建構函式，主要負責設定學籍表報表的 UI 介面和權限控制。

## 詳細分析

### 1. 基本設定
```csharp
reportName = "學籍表(97學年度入學適用)";
reportPath = "資料統計";
```
- 設定報表名稱為「學籍表(97學年度入學適用)」
- 設定報表路徑為「資料統計」

### 2. 學生頁籤設定
```csharp
button_student = RoleAclSource.Instance["學生"]["報表"];
button_student.Add(new RibbonFeature("Student_Button_OfficialStudentRecordReport2010", "學籍表(97學年度入學適用)"));
MotherForm.RibbonBarItems["學生", reportPath]["報表"]["成績相關報表"][reportName].Enable = UserAcl.Current["Student_Button_OfficialStudentRecordReport2010"].Executable;
MotherForm.RibbonBarItems["學生", reportPath]["報表"]["成績相關報表"][reportName].Click += new EventHandler(button_student_OnClick);
```

**功能說明：**
- 在學生頁籤的「資料統計」→「報表」→「成績相關報表」下新增「學籍表(97學年度入學適用)」選項
- 設定按鈕權限控制，只有具備 `Student_Button_OfficialStudentRecordReport2010` 權限的使用者才能執行
- 綁定點擊事件到 `button_student_OnClick` 方法

### 3. 班級頁籤設定
```csharp
button_class = RoleAclSource.Instance["班級"]["報表"];
button_class.Add(new RibbonFeature("Class_Button_OfficialStudentRecordReport2010", "學籍表(97學年度入學適用)"));
MotherForm.RibbonBarItems["班級", reportPath]["報表"]["成績相關報表"][reportName].Enable = UserAcl.Current["Class_Button_OfficialStudentRecordReport2010"].Executable;
MotherForm.RibbonBarItems["班級", reportPath]["報表"]["成績相關報表"][reportName].Click += new EventHandler(button_class_OnClick);
```

**功能說明：**
- 在班級頁籤的「資料統計」→「報表」→「成績相關報表」下新增「學籍表(97學年度入學適用)」選項
- 設定按鈕權限控制，只有具備 `Class_Button_OfficialStudentRecordReport2010` 權限的使用者才能執行
- 綁定點擊事件到 `button_class_OnClick` 方法

### 4. 資源清理
```csharp
button_student = null;
button_class = null;
```
在建構函式結束時將按鈕變數設為 null，避免記憶體洩漏。

## 技術特點

1. **權限控制系統**：使用 `RoleAclSource` 和 `UserAcl` 進行細粒度的權限管理
2. **Ribbon UI 整合**：與主表單的 Ribbon 介面整合，提供統一的用戶體驗
3. **事件驅動架構**：使用事件處理器來響應用戶操作
4. **雙重入口**：同時在學生和班級頁籤提供報表功能，增加使用便利性

## 相關檔案
- `FrontForm.cs`：可能包含 `button_student_OnClick` 和 `button_class_OnClick` 的實作
- `TagConfig.cs`：可能包含報表標籤配置
- `ReportDataTransfer.cs`：可能包含報表資料處理邏輯

## 注意事項
- 此報表專為 97 學年度入學的學生設計
- 需要適當的權限設定才能使用
- 按鈕事件處理器需要在其他地方實作

## Todo 1: 新增即將下架報表分類

### 目標
在「成績相關報表」下新增「即將下架報表」分類，將「學籍表(97學年度入學適用)」移動到該分類中。

### 調整方式

#### 1. 保持原有的報表路徑
```csharp
// 保持原有路徑
reportPath = "資料統計";
```

#### 2. 更新學生頁籤設定
```csharp
// 原本路徑
MotherForm.RibbonBarItems["學生", reportPath]["報表"]["成績相關報表"][reportName]

// 調整後路徑
MotherForm.RibbonBarItems["學生", reportPath]["報表"]["成績相關報表"]["即將下架報表"][reportName]
```

#### 3. 更新班級頁籤設定
```csharp
// 原本路徑
MotherForm.RibbonBarItems["班級", reportPath]["報表"]["成績相關報表"][reportName]

// 調整後路徑
MotherForm.RibbonBarItems["班級", reportPath]["報表"]["成績相關報表"]["即將下架報表"][reportName]
```

### 最終路徑結構
- **學生頁籤**：資料統計 > 報表 > 成績相關報表 > 即將下架報表 > 學籍表(97學年度入學適用)
- **班級頁籤**：資料統計 > 報表 > 成績相關報表 > 即將下架報表 > 學籍表(97學年度入學適用)

### 需要修改的檔案
- `OfficialStudentRecordReport2010.cs` 第 36-55 行

### 修改步驟
1. 保持 `reportPath = "資料統計"` 不變
2. 在所有路徑中新增 `["即將下架報表"]` 層級
3. 確保「即將下架報表」分類在主表單的 Ribbon 介面中已存在
4. 測試權限控制是否正常運作

### 注意事項
- 此調整會在「成績相關報表」下新增一層「即將下架報表」分類
- 需要確認「即將下架報表」分類的權限設定
- 建議在測試環境中先驗證功能正常性
- 可能需要更新相關的權限配置檔案
- 報表的最終路徑會變得更深層級
